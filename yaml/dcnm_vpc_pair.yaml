---
module: dcnm_vpc_pair
short_description: DCNM Ansible Module for managing VPC switch pairs required for VPC interfaces.
version_added: "3.5.0"
description:
    - "DCNM Ansible Module for managing VPC switch pairs."
author: Mallik Mudigonda(@mmudigon)
options:
  src_fabric:
    description:
      - Name of the target fabric for VPC switch pair operations
    type: str
    required: true
  state:
    description:
      - The required state of the configuration after module completion.
    type: str
    choices: ['merged', 'replaced', 'overridden', 'deleted', 'query', 'fetch']
    default: merged
  deploy:
    description:
      - Flag indicating if the configuration must be pushed to the switch.
    type: bool
    default: true
  config:
    description:
      - A list of dictionaries containing VPC switch pair information
    type: list
    elements: dict
    default: []
    suboptions:
      peerOneId:
        description:
          - IP Address/Host Name of Peer1 of VPC switch pair.
        type: str
        required: true

      peerTwoId:
        description:
          - IP Address/Host Name of Peer2 of VPC switch pair.
        type: str
        required: true

      templateName:
        description:
          - Name of the template which inlcudes the required parameters for creating the VPC switch pair.
          - This parameter is 'mandatory' if the fabric is of type 'LANClassic' or 'External'. It is optional
            otherwise.
        type: str
        required: true

      profile:
        description:
          - A dictionary of additional VPC switch pair related parameters that must be included while creating VPC switch pairs.
        suboptions:
          ADMIN_STATE:
            description:
              - Flag to enable/disbale administrative state of the interface.
            type: bool
            required: true

          ALLOWED_VLANS:
           description:
             - Vlans that are allowed on the VPC peer link port-channel.
           type: str
           choices: ['none', 'all', 'vlan-range(e.g., 1-2, 3-40)']
           default: all

          DOMAIN_ID:
           description:
             - VPC domain ID.
             - Minimum value is 1 and Maximum value is 1000.
           type: int
           required: true

          FABRIC_NAME:
            description:
              - Name of the target fabric for VPC switch pair operations.
            type: str
            required: true

          KEEP_ALIVE_HOLD_TIMEOUT:
            description:
              - Hold timeout to ignore stale peer keep alive messages.
              - Minimum value is 3 and Maximum value is 10
            type: int
            default: 3

          KEEP_ALIVE_VRF:
            description:
              - Name of the VRF used for keep-alive messages.
            type: str
            required: true

          PC_MODE:
            description:
              - Port channel mode.
            type: str
            choices: ['on', 'active', 'passive']
            default: active

          PEER1_DOMAIN_CONF:
            description:
              Additional CLI for PEER1 vPC Domain.
            type: str
            default: ""

          PEER1_KEEP_ALIVE_LOCAL_IP:
            description:
              - IP address of a L3 interface in non-default VRF on PEER1.
            type: str
            required: true

          PEER1_MEMBER_INTERFACES:
            description:
              - A list of member interfaces for PEER1.
            type: list
            elements: str
            default: []

          PEER1_PCID:
            description:
              - PEER1 peerlink port-channel number.
              - Minimum value is 1 and Maximum value is 4096.
            type: int
            default: 1

          PEER1_PO_CONF:
            description:
              - Additional CLI for PEER1 vPC peerlink port-channel.
            type: str
            default: ""

          PEER1_PO_DESC:
            description:
              - Description for the PEER1 port-channel.
              - Minimum length is 1 and Maximum length is 254.
            type: str
            default: ""

          PEER2_DOMAIN_CONF:
            description:
              Additional CLI for PEER2 vPC Domain.
            type: str
            default: ""

          PEER2_KEEP_ALIVE_LOCAL_IP:
            description:
              - IP address of a L3 interface in non-default VRF on PEER2.
            type: str
            required: true

          PEER2_MEMBER_INTERFACES:
            description:
              - A list of member interfaces for PEER2.
            type: list
            elements: str
            default: []

          PEER2_PCID:
            description:
              - PEER2 peerlink port-channel number.
              - Minimum value is 1 and Maximum value is 4096.
            type: int
            default: 1

          PEER2_PO_CONF:
            description:
              - Additional CLI for PEER2 vPC peerlink port-channel.
            type: str
            default: ""

          PEER2_PO_DESC:
            description:
              - Description for the PEER2 port-channel.
              - Minimum length is 1 and Maximum length is 254.
            type: str
            default: ""

  templates:
    description:
      - List of templates to be fetched.
      - This is required only if the 'state' is 'fetch'. In this case the list should contain the template names whose details.
        are to be fetched.
    type: list
    elements: str
    default: []
