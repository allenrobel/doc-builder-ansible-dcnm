---
module: dcnm_network
short_description: Add and remove Networks from a DCNM managed VXLAN fabric.
version_added: "0.9.0"
description:
    - "Add and remove Networks from a DCNM managed VXLAN fabric."
    - "In Multisite fabrics, Networks can be created only on Multisite fabric"
author: Chris Van Heuveln(@chrisvanheuveln), Shrishail Kariyappanavar(@nkshrishail) Praveen Ramoorthy(@praveenramoorthy)
options:
  fabric:
    description:
    - Name of the target fabric for network operations
    type: str
    required: yes
  state:
    description:
    - The state of DCNM after module completion.
    type: str
    choices:
      - merged
      - replaced
      - overridden
      - deleted
      - query
    default: merged
  config:
    description:
    - List of details of networks being managed. Not required for state deleted
    type: list
    elements: dict
    suboptions:
      net_name:
        description:
        - Name of the network being managed
        type: str
        required: true
      vrf_name:
        description:
        - Name of the VRF to which the network belongs to
        - This field is required for L3 Networks. VRF name should not be specified
          or may be specified as "" for L2 networks
        type: str
      net_id:
        description:
        - ID of the network being managed
        - If not specified in the playbook, DCNM will auto-select an available net_id
        type: int
        required: false
      net_template:
        description:
        - Name of the config template to be used
        type: str
        default: 'Default_Network_Universal'
      net_extension_template:
        description:
        - Name of the extension config template to be used
        type: str
        default: 'Default_Network_Extension_Universal'
      vlan_id:
        description:
        - VLAN ID for the network.
        - If not specified in the playbook, DCNM will auto-select an available vlan_id
        type: int
        required: false
      routing_tag:
        description:
        - Routing Tag for the network profile
        type: int
        required: false
        default: 12345
      gw_ip_subnet:
        description:
        - Gateway with subnet for the network
        type: str
        required: false
      is_l2only:
        description:
        - Layer 2 only network
        - If specified as true, VRF Name(vrf_name) should not be specified or can be
          specified as ""
        type: bool
        required: false
        default: false
      vlan_name:
        description:
        - Name of the vlan configured
        - if > 32 chars enable, system vlan long-name on switch
        type: str
        required: false
      int_desc:
        description:
        - Description for the interface
        type: str
        required: false
      mtu_l3intf:
        description:
        - MTU for Layer 3 interfaces
        - Configured MTU value should be in range 68-9216
        type: int
        required: false
      arp_suppress:
        description:
        - ARP suppression
        - ARP suppression is only supported if SVI is present when Layer-2-Only is not enabled
        type: bool
        required: false
        default: false
      dhcp_srvr1_ip:
        description:
        - DHCP relay IP address of the first DHCP server
        type: str
        required: false
      dhcp_srvr1_vrf:
        description:
        - VRF ID of first DHCP server
        type: str
        required: false
      dhcp_srvr2_ip:
        description:
        - DHCP relay IP address of the second DHCP server
        type: str
        required: false
      dhcp_srvr2_vrf:
        description:
        - VRF ID of second DHCP server
        type: str
        required: false
      dhcp_srvr3_ip:
        description:
        - DHCP relay IP address of the third DHCP server
        type: str
        required: false
      dhcp_srvr3_vrf:
        description:
        - VRF ID of third DHCP server
        type: str
        required: false
      dhcp_loopback_id:
        description:
        - Loopback ID for DHCP Relay interface
        - Configured ID value should be in range 0-1023
        type: int
        required: false
      multicast_group_address:
        description:
        - The multicast IP address for the network
        type: str
        required: false
      gw_ipv6_subnet:
        description:
        - IPv6 Gateway with prefix for the network
        type: str
        required: false
      secondary_ip_gw1:
        description:
        - IP address with subnet for secondary gateway 1
        type: str
        required: false
      secondary_ip_gw2:
        description:
        - IP address with subnet for secondary gateway 2
        type: str
        required: false
      secondary_ip_gw3:
        description:
        - IP address with subnet for secondary gateway 3
        type: str
        required: false
      secondary_ip_gw4:
        description:
        - IP address with subnet for secondary gateway 4
        type: str
        required: false
      trm_enable:
        description:
        - Enable Tenant Routed Multicast
        type: bool
        required: false
        default: false
      route_target_both:
        description:
        - Enable both L2 VNI Route-Target
        type: bool
        required: false
        default: false
      l3gw_on_border:
        description:
        - Enable L3 Gateway on Border
        type: bool
        required: false
        default: false
      netflow_enable:
        description:
        - Enable Netflow
        - Netflow is supported only if it is enabled on fabric
        - Netflow configs are supported on NDFC only
        type: bool
        required: false
        default: false
      intfvlan_nf_monitor:
        description:
        - Interface Vlan Netflow Monitor
        - Applicable only if 'Layer 2 Only' is not enabled. Provide monitor name defined in fabric setting for Layer 3 Record
        - Netflow configs are supported on NDFC only
        type: str
        required: false
      vlan_nf_monitor:
        description:
        - Vlan Netflow Monitor
        - Provide monitor name defined in fabric setting for Layer 3 Record
        - Netflow configs are supported on NDFC only
        type: str
        required: false
      attach:
        description:
        - List of network attachment details
        type: list
        elements: dict
        suboptions:
          ip_address:
            description:
            - IP address of the switch where the network will be attached or detached
            type: str
            required: true
          ports:
            description:
            - List of switch interfaces where the network will be attached
            type: list
            elements: str
            required: true
          deploy:
            description:
            - Per switch knob to control whether to deploy the attachment
            - This knob has been deprecated from Ansible NDFC Collection Version 2.1.0 onwards.
              There will not be any functional impact if specified in playbook.
            type: bool
            default: true
          tor_ports:
            description:
            - List of interfaces in the paired TOR switch for this leaf where the network will be attached
            - Please attach the same set of TOR ports to both the VPC paired switches.
            type: list
            elements: dict
            required: false
            suboptions:
              ip_address:
                description:
                - IP address of the TOR switch where the network will be attached
                type: str
                required: true
              ports:
                description:
                - List of TOR switch interfaces where the network will be attached
                type: list
                elements: str
                required: true
      deploy:
        description:
        - Global knob to control whether to deploy the attachment
        - Ansible NDFC Collection Behavior for Version 2.0.1 and earlier
        - This knob will create and deploy the attachment in DCNM only when set to "True" in playbook
        - Ansible NDFC Collection Behavior for Version 2.1.0 and later
        - Attachments specified in the playbook will always be created in DCNM.
          This knob, when set to "True",  will deploy the attachment in DCNM, by pushing the configs to switch.
          If set to "False", the attachments will be created in DCNM, but will not be deployed
        type: bool
        default: true
