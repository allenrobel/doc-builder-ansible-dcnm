---
module: dcnm_service_route_peering
short_description: DCNM Ansible Module for managing Service Route Peerings.
version_added: "1.2.0"
description:
    - DCNM Ansible Module for Creating, Deleting, Querying and Modifying Route Peerings
author: Mallik Mudigonda (@mmudigon)
options:
  fabric:
    description:
      - 'Name of the target fabric for route peering operations'
    type: str
    required: true
  service_fabric:
    description:
      - 'Name of the external fabric attached to the service node for route peering operations'
    type: str
    required: true
  state:
    description:
      - The required state of the configuration after module completion.
    type: str
    required: false
    choices:
      - merged
      - replaced
      - overridden
      - deleted
      - query
    default: merged
  attach:
    description:
      - A flag specifying if the given route peering is to be attached to the specified service node
    type: bool
    required: false
    default: true
  deploy:
    description:
      - A flag specifying if a route peering is to be deployed on the switches
    type: bool
    required: false
    default: true
  config:
    description:
      - A list of dictionaries containing route peering and switch information
    type: list
    elements: dict
    suboptions:
      name:
        description:
          - A unique name which identifies the route peering
        type: str
        required: true
      node_name:
        description:
          - Name of the service node where the route peering is to be deployed
        type: str
        required: true
      deploy_mode:
        description:
          - Type of service node.
        type: str
        required: true
        choices: ['intra_tenant_fw', 'inter_tenant_fw', 'one_arm_adc', 'two_arm_adc']
      peering_option:
        description:
          - Specifies the type of peering
          - This parameter is applicable only when 'deploy_mode' is either 'inter_tenant_fw'
            or 'one_arm_adc' or 'two_arm_adc'
        type: str
        required: False
        default: 'static'
        choices: ['static', 'ebgp']
      next_hop:
        description:
          - Nexthop IPV4 information, e.g., 192.168.1.100
          - This parameter is applicable only when 'deploy_mode' is 'intra_tenant_fw'
        type: int
        required: true
      reverse_next_hop:
        description:
          - Reverse Nexthop IPV4 information, e.g., 192.169.1.100
          - This parameter is applicable only when 'deploy_mode' is either 'intra_tenant_fw'
            or 'one_arm_adc' or 'two_arm_adc'
        type: str
        required: false
        default: ""
      inside_network:
        description:
          - Details regarding inside network of the route peering
          - This parameter is applicable only when 'deploy_mode' is 'intra_tenant_fw'
            or 'inter_tenant_fw'
        type: dict
        required: true
        suboptions:
          vrf:
            description:
              - VRF name for the inside network
            type: str
            required: true
          name:
            description:
              - Network name
            type: str
            required: true
          vlan_id:
            description:
              - Vlan Id for the inside network
              - If this object is included and if it is already in use, then the module will allocate a new
                VLAN ID and create the Route Peering. The user provided 'vlan_id' will be ignored.
            type: int
            required: false
            default: 0
          profile:
            description:
              - Profile information for the inside network
            type: dict
            required: true
            suboptions:
              ipv4_gw:
                description:
                  - IPV4 gateway information including the mask e.g. 192.168.1.1/24
                type: str
                required: true
              ipv6_gw:
                description:
                  - IPV6 gateway information including the mask e.g., 2000:01:01::01/64
                type: str
                required: false
                default: ""
              vlan_name:
                description:
                  - Vlan name
                type: str
                required: false
                default: ""
              int_descr:
                description:
                  - Description of the interface
                type: str
                required: false
                default: ""
              tag:
                description:
                  - Route tag information
                type: int
                required: false
                default: 12345
              static_route:
                description:
                  - Static route information
                  - This parameter is applicable only when 'peering_option' is 'static'
                type: list
                elements: dict
                required: false
                default: []
                suboptions:
                  subnet:
                    description:
                      - Subnet information, for e.g., 11.0.0.0/24
                    type: str
                    required: True
                  next_hop:
                    description:
                      - Gateway IP addresses, for e.g., 192.168.1.1
                    type: list
                    elements: str
                    required: True
              ipv4_neighobor:
                description:
                  - IPv4 neighbor address
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: str
                required: True
              ipv4_lo:
                description:
                  - IPv4 loopback address
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: str
                required: True
              ipv4_vpc_peer_lo:
                description:
                  - IPv4 vpc peer loopback address
                  - This parameter is applicable only when 'peering_option' is 'ebgp'.
                    This parameter is mandatory if the service node is part of VPC switch
                    pair
                type: str
                required: False
                default: ''
              ipv6_neighbor:
                description:
                  - IPv6 neighbor address
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: str
                required: False
                default: ''
              ipv6_lo:
                description:
                  - IPv6 loopback address
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: str
                required: False
                default: ''
              ipv6_vpc_peer_lo:
                description:
                  - IPv6 vpc peer loopback address
                  - This parameter is applicable only when 'peering_option' is 'ebgp'. This
                    object is mandatory if the service node switch is part of VPC
                    pair
                type: str
                required: False
                default: ''
              route_map_tag:
                description:
                  - Route Tag
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: int
                default: 12345
              neigh_int_descr:
                description:
                  - Description of the interface
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: str
                required: False
                default: ''
              local_asn:
                description:
                  - Local ASN number
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: int
                required: False
                default: 12345
              adv_host:
                description:
                  - Flag indicating if the host is to be advertised
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: bool
                required: False
                default: True
      outside_network:
        description:
          - Details regarding outside network of the route peering
          - This parameter is applicable only when 'deploy_mode' is 'intra_tenant_fw'
            or 'inter_tenant_fw'
        type: dict
        required: true
        suboptions:
          vrf:
            description:
              - VRF name for the outside network
            type: str
            required: true
          name:
            description:
              - Network name
            type: str
            required: true
          vlan_id:
            description:
              - Vlan Id for the outside network
              - If this object is included and if it is already in use, then the module will allocate a new
                VLAN ID and create the Route Peering. The user provided 'vlan_id' will be ignored.
            type: int
            required: false
            default: 0
          profile:
            description:
              - Profile information for the outside network
            type: dict
            required: true
            suboptions:
              ipv4_gw:
                description:
                  - IPV4 gateway information including the mask e.g. 192.168.1.1/24
                type: str
                required: true
              ipv6_gw:
                description:
                  - IPV6 gateway information including the mask e.g., 2000:01:01::01/64
                type: str
                required: false
                default: ""
              vlan_name:
                description:
                  - Vlan name
                type: str
                required: false
                default: ""
              int_descr:
                description:
                  - Description of the interface
                type: str
                required: false
                default: ""
              tag:
                description:
                  - Route tag information
                type: int
                required: false
                default: 12345
              static_route:
                description:
                  - Static route information
                  - This parameter is applicable only when 'peering_option' is 'static' and
                    'deploy_mode' is 'intra_tenant_fw'
                type: list
                elements: dict
                required: false
                default: []
                suboptions:
                  subnet:
                    description:
                      - Subnet information, for e.g., 11.0.0.0/24
                    type: str
                    required: True
                  next_hop:
                    description:
                      - Gateway IP addresses, for e.g., 192.168.1.1
                    type: list
                    elements: str
                    required: True
              ipv4_neighobor:
                description:
                  - IPv4 neighbor address
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: str
                required: True
              ipv4_lo:
                description:
                  - IPv4 loopback address
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: str
                required: True
              ipv4_vpc_peer_lo:
                description:
                  - IPv4 vpc peer loopback address
                  - This parameter is applicable only when 'peering_option' is 'ebgp'.
                    This parameter is mandatory if the service node is part of VPC switch
                    pair
                type: str
                required: False
                default: ''
              ipv6_neighbor:
                description:
                  - IPv6 neighbor address
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: str
                required: False
                default: ''
              ipv6_lo:
                description:
                  - IPv6 loopback address
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: str
                required: False
                default: ''
              ipv6_vpc_peer_lo:
                description:
                  - IPv6 vpc peer loopback address
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                    This parameter is mandatory if the service node is part of VPC switch
                    pair
                type: str
                required: False
                default: ''
              route_map_tag:
                description:
                  - Route Tag
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: int
                default: 12345
              neigh_int_descr:
                description:
                  - Description of the interface
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: str
                required: False
                default: ''
              local_asn:
                description:
                  - Local ASN number
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: int
                required: False
                default: 12345
              adv_host:
                description:
                  - Flag indicating if the host is to be advertised
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: bool
                required: False
                default: true
      first_arm:
        description:
          - Details regarding first arm of the route peering
          - This parameter is applicable only when 'deploy_mode' is either
            'one_arm_adc' or 'two_arm_adc'
        type: dict
        required: true
        suboptions:
          vrf:
            description:
              - VRF name for the first arm
            type: str
            required: true
          name:
            description:
              - Network name
            type: str
            required: true
          vlan_id:
            description:
              - Vlan Id for the  first arm
              - If this object is included and if it is already in use, then the module will allocate a new
                VLAN ID and create the Route Peering. The user provided 'vlan_id' will be ignored.
            type: int
            required: false
            default: 0
          profile:
            description:
              - Profile information for the first arm
            type: dict
            required: true
            suboptions:
              ipv4_gw:
                description:
                  - IPV4 gateway information including the mask e.g. 192.168.1.1/24
                type: str
                required: true
              ipv6_gw:
                description:
                  - IPV6 gateway information including the mask e.g., 2000:01:01::01/64
                type: str
                required: false
                default: ""
              vlan_name:
                description:
                  - Vlan name
                type: str
                required: false
                default: ""
              int_descr:
                description:
                  - Description of the interface
                type: str
                required: false
                default: ""
              tag:
                description:
                  - Route tag information
                type: int
                required: false
                default: 12345
              static_route:
                description:
                  - Static route information
                  - This parameter is applicable only when 'peering_option' is 'static'
                type: list
                elements: dict
                required: false
                default: []
                suboptions:
                  subnet:
                    description:
                      - Subnet information, for e.g., 11.0.0.0/24
                    type: str
                    required: True
                  next_hop:
                    description:
                      - Gateway IP addresses, for e.g., 192.168.1.1
                    type: list
                    elements: str
                    required: True
              ipv4_neighobor:
                description:
                  - IPv4 neighbor address
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: str
                required: True
              ipv4_lo:
                description:
                  - IPv4 loopback address
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: str
                required: True
              ipv4_vpc_peer_lo:
                description:
                  - IPv4 vpc peer loopback address
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                    This parameter is mandatory if the service node is part of VPC switch
                    pair
                type: str
                required: False
                default: ''
              ipv6_neighbor:
                description:
                  - IPv6 neighbor address
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: str
                required: False
                default: ''
              ipv6_lo:
                description:
                  - IPv6 loopback address
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: str
                required: False
                default: ''
              ipv6_vpc_peer_lo:
                description:
                  - IPv6 vpc peer loopback address
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                    This parameter is mandatory if the service node is part of VPC switch
                    pair
                type: str
                required: False
                default: ''
              route_map_tag:
                description:
                  - Route Tag
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: int
                default: 12345
              neigh_int_descr:
                description:
                  - Description of the interface
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: str
                required: False
                default: ''
              local_asn:
                description:
                  - Local ASN number
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: int
                required: False
                default: 12345
              adv_host:
                description:
                  - Flag indicating if the host is to be advertised
                  - This parameter is applicable only when 'peering_option' is 'ebgp'
                type: bool
                required: False
                default: True
      second_arm:
        description:
          - Details regarding second arm of the route peering
          - This parameter is applicable only when 'deploy_mode' is either
            'one_arm_adc' or 'two_arm_adc'
        type: dict
        required: true
        suboptions:
          vrf:
            description:
              - VRF name for the second arm
            type: str
            required: true
          name:
            description:
              - Network name
            type: str
            required: true
          vlan_id:
            description:
              - Vlan Id for the second arm
              - If this object is included and if it is already in use, then the module will allocate a new
                VLAN ID and create the Route Peering. The user provided 'vlan_id' will be ignored.
            type: int
            required: false
            default: 0
          profile:
            description:
              - Profile information for the second arm
            type: dict
            required: true
            suboptions:
              ipv4_gw:
                description:
                  - IPV4 gateway information including the mask e.g. 192.168.1.1/24
                type: str
                required: true
              ipv6_gw:
                description:
                  - IPV6 gateway information including the mask e.g., 2000:01:01::01/64
                type: str
                required: false
                default: ""
              vlan_name:
                description:
                  - Vlan name
                type: str
                required: false
                default: ""
              int_descr:
                description:
                  - Description of the interface
                type: str
                required: false
                default: ""
              tag:
                description:
                  - Route tag information
                type: int
                required: false
                default: 12345
